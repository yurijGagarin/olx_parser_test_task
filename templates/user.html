{% extends 'base.html' %}
{% block head %}
Menu
{% endblock %}

{% block content %}

<style>
    html,
    body {
        height: 100%;
    }
    .myButton {
	box-shadow: 0px 0px 0px 2px #9fb4f2;
	background:linear-gradient(to bottom, #7892c2 5%, #476e9e 100%);
	background-color:#7892c2;
	border-radius:42px;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Georgia;
	font-size:22px;
	padding:16px 43px;
	text-decoration:none;
	text-shadow:0px 1px 0px #283966;
}
.myButton:hover {
	background:linear-gradient(to bottom, #476e9e 5%, #7892c2 100%);
	background-color:#476e9e;
}
.myButton:active {
	position:relative;
	top:1px;
}

</style>

<h2><button class="myButton" onclick="refresh()">Refresh</button></h2>

<div class="row">
        <div class="col-md">
            <div class="card">
                <div class="card-header">
                    <h5>Listings</h5>
                </div>
                <div class="card-body">
                    <table style="display: none; width: 100%" id="dataTable">
                        <tr>
                            <th>Name</th>
                            <th>Image</th>
                            <th>Price</th>
                            <th><center><em class="fa fa-cog" ></em></center></th>
                        </tr>
                    </table>
                </div>

            </div>
        </div>
    </div>

<script>
  function refresh() {
    console.log('Refresh');
    const table = document.getElementById('dataTable');
    const data = JSON.parse(httpGet('/data'));

    table.style.display = 'table';
    data.forEach(function (datum) {
      console.log(datum);
      const row = table.insertRow();
      row.insertCell().innerHTML = datum['name'];
      row.insertCell().innerHTML = `<img style="width: 100px" src="${datum['img']}">`;
      row.insertCell().innerHTML = datum['price'];
      row.insertCell().innerHTML = '<input class="btn btn-danger" type="button" value="Delete Row" onclick="removeRow(this)">';
    });

  }


 function removeRow(o) {
     const p = o.parentNode.parentNode;
     p.parentNode.removeChild(p);
    }
  function httpGet(theUrl) {
    const xmlHttp = new XMLHttpRequest();
    xmlHttp.open("GET", theUrl, false);
    xmlHttp.send(null);
    return xmlHttp.responseText;
  }
</script>


{% endblock %}






